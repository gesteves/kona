<aside class="sidebar">
  <picture>
      <% ["avif", "webp", "jpg"].each do |format| %>
        <%= source_tag(data.site.author.profilePicture.url, sizes: '(min-width: 768px) 96px, 48px', type: "image/#{format}", format: format, widths: [48, 96, 144]) %>
      <% end %>
      <img src="<%= data.site.author.profilePicture.url %>" alt="<%= data.site.author.profilePicture.title %>" width="<%= data.site.author.profilePicture.width %>" height="<%= data.site.author.profilePicture.height %>" loading="eager" decoding="async" class="sidebar__avatar" >
    </picture>

  <%= render_body(data.site.blurb) %>

  <ul class="sidebar__links">
      <% pages = data.pages.select { |p| !p.draft }.map { |p| [p.menuLabel.presence || p.title, p.path] }.compact %>
      <% pages.sort { |a,b| a.first <=> b.first }.each do |p| %>
        <li><%= link_to p.first, p.last %></li>
      <% end %>
      <li><%= link_to "Contact", "mailto:#{data.site.email}" %></li>
      <li><%= link_to "Feed", "/feed.xml" %></li>
      <% if data.site.bluesky.present? %>
        <li><%= link_to "Bluesky", data.site.bluesky, rel: "me noopener", target: "_blank" %></li>
      <% end %>
      <% if data.site.instagram.present? %>
        <li><%= link_to "Instagram", data.site.instagram, rel: "me noopener", target: "_blank" %></li>
      <% end %>
      <% if data.site.mastodon.present? %>
        <li><%= link_to "Mastodon", data.site.mastodon, rel: "me noopener", target: "_blank" %></li>
      <% end %>
      <% if data.site.strava.present? %>
        <li><%= link_to "Strava", data.site.strava, rel: "me noopener", target: "_blank" %></li>
      <% end %>
    </ul>

    <p>© <%= data.articles.reject(&:draft).map { |a| DateTime.parse(a.published_at) }.min.strftime('%Y') %>–<%= Time.now.strftime('%Y') %> <%= data.site.copyright %></p>
</aside>
